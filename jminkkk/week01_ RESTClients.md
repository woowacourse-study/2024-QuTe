# 외부 API 통신
### Spring 에서 외부 API를 호출하는 방법은 어떤 것들이 있나요?

- RestTemplate, RestClient, WebClient가 있습니다.
- 동기식 Client는 RestTemplate와 RestClient가 있으며
- 비동기식은 WebClient가 있습니다.

### RestTemplate vs WebClient의 차이점에 대해 설명해주세요.

RestTemplate는 동기식 블로킹 방식을 사용합니다.

반면 WebClient는 비동기식 논블로킹 방식을 사용합니다.

따라서 RestTemplate로 외부 API 통신을 처리하게 되면 기존 API 전체가 해당 요청이 끝날 때까지 대기하여야 합니다.

반면 WebClient는 비동기식 논블로킹으로 처리하기 때문에 요청을 보냄과 동시에 제어권을 반환받습니다.(논블로킹)

그 후 요청 처리가 끝났다면 콜백 함수 등을 통해 처리합니다.

### 외부 API 사용 시 발생할 수 있는 예외 상황들에 대해 설명해주세요.

ConnectionException과 같은 네트워크 오류, 데이터 파싱 등에 대한 예외 상황들이 있을 것 같습니다.

### **Connection Timeout과 Read Timeout의 의미와 설정 이유에 대해 말해주세요.**

### Connection Timeout

요청을 보내는 서버에 연결하는데 소요되는 최대 시간을 의미합니다.

설정 이유는 네트워크 문제나 서버 장애 시 무한정 대기하는 것을 방지하며, 소켓 등 네트워크를 효율적으로 관리할 수 있습니다.

### Read Timeout

요청을 보낸 서버가 처리하는데에 소요할 수 있는 최대 시간을 의미합니다.

서버 처리 지연이나 네트워크 속도 저하로 인한 무한 대기를 방지하고 전체 시스템의 안정성을 향상시킵니다.

### Connection Timeout, Read Timeout 각 값은 어떻게 설정할 수 있을까요?

Connection Timeout은 일반적인 네트워크 환경에서 TCP 연결 설정은 보통 수백 밀리초 이내에 완료됩니다.

하지만 네트워크 라우팅 문제, DNS 조회 지연 등으로 인해 연결 설정이 지연될 수 있기 때문에 2-10초의 정도로 설정하는 것이 적절합니다.

10초 이상 기다리는 것은 대부분의 상황에서 비효율적이며, 사용자 경험을 해칠 수 있습니다.

Read Timeout은 요청을 보낸 API의 복잡도 등 서버의 평균 응답 시간을 고려하는 것이 적절합니다. 만약 클라이언트가 빠른 응답이 필요하다면 값을 낮춰 빠른 실패가 가능하도록 할 수 있습니다.

### 동기식으로 처리했을 때의 문제점과 비동기식으로 처리하는 이유에 대해 말해주세요.

먼저 동기식 블로킹은 요청이 완료될 때까지 스레드가 대기합니다. 논블로킹으로 처리해도 주기적으로 작업 완료를 확인해야 하기 때문에 있어 리소스를 비효율적으로 사용합니다.

반면 비동기는 여러 작업을 동시에 처리 가능하기 때문에 WebClient가 더 리소스 활용도가 높고, API 속도를 개선할 수 있습니다.

(비동기 논블로킹 방식은 보통 굳이 사용하지 않기 때문에 제외하겠습니다. 비동기의 이점을 전혀 살리지 못함. 안티패턴)
